<!DOCTYPE html>
<html>
<head>
	<title>This report was made by Daniel, David and Matt.</title>
	<style type="text/css">iframe {width:100%;height:600px}</style>
	<script>
		function openTab(tabName) {
			for (tag of document.getElementsByClassName("tab")) {
				tag.style.visibility = "hidden";
			}
			document.getElementById(tabName).style.visibility = "visible";  
		}
		window.onload = function(){ document.getElementById("loading").style.display = "none" }
	</script>
	<style type="text/css">
		.tab {position:fixed; top:30px; left:0px; width:100%; height:100vh; visibility:hidden}
		#loading {width:100%; height:100%; top:0px; left:0px; position:fixed; display:block; z-index:99; background-color:rgba(0,0,0,0.5); text-align:center; line-height:60vh; font-size:80pt; font-family:Helvetica,Arial,Sans-Serif; text-shadow:0px 0px 5px white}
	</style>
</head>
<body style="margin:0px; height:30px">
	<div id="loading">Loading</div>
	<div>
		<button onclick="openTab('overview')">Overview</button>
		<button onclick="openTab('oneline')">Oneline</button>
		<button onclick="openTab('map')">Map</button>
		<button onclick="openTab('interconnection')">Interconnection</button>
		<button onclick="openTab('control')">Control</button>
		
			<button onclick="openTab('reopt_final_0')">reopt_final_0</button>
		
			<button onclick="openTab('reopt_final_1')">reopt_final_1</button>
		
			<button onclick="openTab('reopt_final_2')">reopt_final_2</button>
		
			<button onclick="openTab('reopt_final_3')">reopt_final_3</button>
		
	</div>
	<div id="overview" class="tab" style="margin:5px; overflow:scroll; visibility:visible">
		<pre style="width:95%; white-space:pre-wrap">Report Generated on 2021-06-23 09:29:29.307891</pre>
		<pre style="width:95%; white-space:pre-wrap">INPUTS: {'circuit': 'circuit_plusmg_2.dss', 'loads': 'lehigh_load.csv', 'Maximum Proportion of critical load to be served by fossil generation': 1, 'REopt inputs': {'solar': 'on', 'wind': 'off', 'battery': 'on', 'year': '2017', 'energyCost': '0.12', 'demandCost': '20', 'wholesaleCost': '0.034', 'solarCost': '1600', 'windCost': '4989', 'batteryPowerCost': '840', 'batteryCapacityCost': '420', 'dieselGenCost': '500', 'solarMin': 0, 'windMin': 0, 'batteryPowerMin': 0, 'batteryCapacityMin': 0, 'solarMax': '100000', 'windMax': '100000', 'batteryPowerMax': '1000000', 'batteryCapacityMax': '1000000', 'dieselMax': '1000000', 'solarExisting': 0, 'criticalLoadFactor': '1', 'outageDuration': '48', 'fuelAvailable': '50000', 'genExisting': 0, 'minGenLoading': '0.3', 'batteryKwExisting': 0, 'batteryKwhExisting': 0, 'windExisting': 0, 'value_of_lost_load': '100', 'solarCanCurtail': True, 'solarCanExport': True}, 'microgrid': {'mg0': {'loads': ['634a_data_center', '634b_radar', '634c_atc_tower'], 'switch': '632633', 'gen_bus': '634', 'gen_obs_existing': ['solar_634_existing', 'battery_634_existing'], 'critical_load_kws': [70, 90, 10], 'max_potential_battery': '700', 'max_potential_diesel': '1000000', 'battery_capacity': '10000'}, 'mg1': {'loads': ['675a_hospital', '675b_residential1', '675c_residential1'], 'switch': '671692', 'gen_bus': '675', 'gen_obs_existing': ['solar_675_existing'], 'critical_load_kws': [150, 200, 200], 'max_potential_battery': '900', 'max_potential_diesel': '300', 'battery_capacity': '20000'}, 'mg2': {'loads': ['684_command_center', '652_residential'], 'switch': '671684', 'gen_bus': '684', 'gen_obs_existing': ['diesel_684_existing', 'battery_684_existing'], 'critical_load_kws': [400, 20], 'max_potential': '1300', 'max_potential_diesel': '1000000', 'battery_capacity': '10000'}, 'mg3': {'loads': ['645_hangar', '646_office'], 'switch': '632645', 'gen_bus': '646', 'gen_obs_existing': [], 'critical_load_kws': [30, 70], 'max_potential_battery': '800', 'max_potential_diesel': '1000000', 'battery_capacity': '10000'}}}</pre>
		<pre style="width:95%; white-space:pre-wrap">User Warnings:</pre>
		<pre style="width:95%; white-space:pre-wrap">Pre-existing battery battery_634_existing will not be utilized to support loads in microgrid mg0.
Pre-existing battery battery_684_existing will not be utilized to support loads in microgrid mg2.
</pre>
		<!-- formatted below for a dict of lists -->
		<pre>Overview of Microgrids</pre>
		<table style="">
			
				<tr>
					<td>Microgrid Name</td>
					
						
							<td style="text-align:right">mg0</td>
						
					
						
							<td style="text-align:right">mg1</td>
						
					
						
							<td style="text-align:right">mg2</td>
						
					
						
							<td style="text-align:right">mg3</td>
						
					
						
							<td style="text-align:right">Summary</td>
						
					
				</tr>
			
				<tr>
					<td>Generation Bus</td>
					
						
							<td style="text-align:right">634</td>
						
					
						
							<td style="text-align:right">675</td>
						
					
						
							<td style="text-align:right">684</td>
						
					
						
							<td style="text-align:right">646</td>
						
					
						
							<td style="text-align:right">None</td>
						
					
				</tr>
			
				<tr>
					<td>Minimum 1 hr Load (kW)</td>
					
						
							<td style="text-align:right">56</td>
						
					
						
							<td style="text-align:right">211</td>
						
					
						
							<td style="text-align:right">213</td>
						
					
						
							<td style="text-align:right">17</td>
						
					
						
							<td style="text-align:right">497</td>
						
					
				</tr>
			
				<tr>
					<td>Average 1 hr Load (kW)</td>
					
						
							<td style="text-align:right">178</td>
						
					
						
							<td style="text-align:right">402</td>
						
					
						
							<td style="text-align:right">549</td>
						
					
						
							<td style="text-align:right">138</td>
						
					
						
							<td style="text-align:right">1,267</td>
						
					
				</tr>
			
				<tr>
					<td>Average Daytime 1 hr Load (kW)</td>
					
						
							<td style="text-align:right">247.0</td>
						
					
						
							<td style="text-align:right">497.0</td>
						
					
						
							<td style="text-align:right">682.0</td>
						
					
						
							<td style="text-align:right">214.0</td>
						
					
						
							<td style="text-align:right">1,640</td>
						
					
				</tr>
			
				<tr>
					<td>Maximum 1 hr Load (kW)</td>
					
						
							<td style="text-align:right">306</td>
						
					
						
							<td style="text-align:right">708</td>
						
					
						
							<td style="text-align:right">893</td>
						
					
						
							<td style="text-align:right">379</td>
						
					
						
							<td style="text-align:right">2,286</td>
						
					
				</tr>
			
				<tr>
					<td>Maximum 1 hr Critical Load (kW)</td>
					
						
							<td style="text-align:right">170</td>
						
					
						
							<td style="text-align:right">550</td>
						
					
						
							<td style="text-align:right">420</td>
						
					
						
							<td style="text-align:right">100</td>
						
					
						
							<td style="text-align:right">1,240</td>
						
					
				</tr>
			
				<tr>
					<td>Existing Fossil Generation (kW)</td>
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">81</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">81</td>
						
					
				</tr>
			
				<tr>
					<td>New Fossil Generation (kW)</td>
					
						
							<td style="text-align:right">62</td>
						
					
						
							<td style="text-align:right">342</td>
						
					
						
							<td style="text-align:right">153</td>
						
					
						
							<td style="text-align:right">15</td>
						
					
						
							<td style="text-align:right">572</td>
						
					
				</tr>
			
				<tr>
					<td>Diesel Fuel Used During Outage (gal)</td>
					
						
							<td style="text-align:right">156</td>
						
					
						
							<td style="text-align:right">1,006</td>
						
					
						
							<td style="text-align:right">624</td>
						
					
						
							<td style="text-align:right">19</td>
						
					
						
							<td style="text-align:right">1,805</td>
						
					
				</tr>
			
				<tr>
					<td>Existing Solar (kW)</td>
					
						
							<td style="text-align:right">440</td>
						
					
						
							<td style="text-align:right">800</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">1,240</td>
						
					
				</tr>
			
				<tr>
					<td>New Solar (kW)</td>
					
						
							<td style="text-align:right">191</td>
						
					
						
							<td style="text-align:right">481</td>
						
					
						
							<td style="text-align:right">1,670</td>
						
					
						
							<td style="text-align:right">649</td>
						
					
						
							<td style="text-align:right">2,991</td>
						
					
				</tr>
			
				<tr>
					<td>Existing Battery Power (kW)</td>
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
				</tr>
			
				<tr>
					<td>Existing Battery Energy Storage (kWh)</td>
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
				</tr>
			
				<tr>
					<td>New Battery Power (kW)</td>
					
						
							<td style="text-align:right">80</td>
						
					
						
							<td style="text-align:right">144</td>
						
					
						
							<td style="text-align:right">177</td>
						
					
						
							<td style="text-align:right">110</td>
						
					
						
							<td style="text-align:right">511</td>
						
					
				</tr>
			
				<tr>
					<td>New Battery Energy Storage (kWh)</td>
					
						
							<td style="text-align:right">286</td>
						
					
						
							<td style="text-align:right">432</td>
						
					
						
							<td style="text-align:right">506</td>
						
					
						
							<td style="text-align:right">260</td>
						
					
						
							<td style="text-align:right">1,484</td>
						
					
				</tr>
			
				<tr>
					<td>Existing Wind (kW)</td>
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
				</tr>
			
				<tr>
					<td>New Wind (kW)</td>
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
						
							<td style="text-align:right">0</td>
						
					
				</tr>
			
				<tr>
					<td>Total Generation on Microgrid (kW)</td>
					
						
							<td style="text-align:right">773</td>
						
					
						
							<td style="text-align:right">1,766</td>
						
					
						
							<td style="text-align:right">2,081</td>
						
					
						
							<td style="text-align:right">773</td>
						
					
						
							<td style="text-align:right">5,393</td>
						
					
				</tr>
			
				<tr>
					<td>NPV over 25 years ($)</td>
					
						
							<td style="text-align:right">-17,734</td>
						
					
						
							<td style="text-align:right">-107,571</td>
						
					
						
							<td style="text-align:right">652,787</td>
						
					
						
							<td style="text-align:right">252,842</td>
						
					
						
							<td style="text-align:right">780,324</td>
						
					
				</tr>
			
				<tr>
					<td>CapEx ($)</td>
					
						
							<td style="text-align:right">524,246</td>
						
					
						
							<td style="text-align:right">1,241,945</td>
						
					
						
							<td style="text-align:right">3,109,802</td>
						
					
						
							<td style="text-align:right">1,246,217</td>
						
					
						
							<td style="text-align:right">6,122,210</td>
						
					
				</tr>
			
				<tr>
					<td>CapEx after Incentives ($)</td>
					
						
							<td style="text-align:right">341,911</td>
						
					
						
							<td style="text-align:right">824,141</td>
						
					
						
							<td style="text-align:right">1,823,489</td>
						
					
						
							<td style="text-align:right">732,054</td>
						
					
						
							<td style="text-align:right">3,721,595</td>
						
					
				</tr>
			
				<tr>
					<td>Average Outage Survived (h)</td>
					
						
							<td style="text-align:right">184</td>
						
					
						
							<td style="text-align:right">2,982</td>
						
					
						
							<td style="text-align:right">2,049</td>
						
					
						
							<td style="text-align:right">1,155</td>
						
					
						
							<td style="text-align:right">184</td>
						
					
				</tr>
			
		</table>
	</div>
	<div id="oneline" class="tab" style="visibility:hidden">
		<iframe src="circuit_oneline.html" style="height:100vh"></iframe>
	</div>
	<div id="map" class="tab" style="visibility:hidden">
		<iframe src="circuit_map/geoJsonMap_offline.html" style="height:100vh"></iframe>
	</div>
	<div id="interconnection" class="tab" style="visibility:hidden">
		<div style="height:100vh; overflow:scroll">
			<iframe src="timeseries_gen.csv.plot.html"></iframe>
			<iframe src="timeseries_load.csv.plot.html"></iframe>
			<iframe src="timeseries_source.csv.plot.html"></iframe>
			<iframe src="timeseries_control.csv.plot.html"></iframe>
		</div>
	</div>
	<div id="control" class="tab" style="visibility:hidden">
		<div style="height:100vh; overflow:scroll">
			<!-- <iframe src="timezcontrol_gen.csv.plot.html"></iframe> -->
			<iframe src="timezcontrol_load.csv.plot.html"></iframe>
			<iframe src="timezcontrol_source.csv.plot.html"></iframe>
			<iframe src="timezcontrol_control.csv.plot.html"></iframe>
		</div>
	</div>
	
	<div id="reopt_final_0" class="tab" style="visibility:hidden">
		<iframe src="reopt_final_0/inlineTemplate.html" style="height:100vh"></iframe>
	</div>
	
	<div id="reopt_final_1" class="tab" style="visibility:hidden">
		<iframe src="reopt_final_1/inlineTemplate.html" style="height:100vh"></iframe>
	</div>
	
	<div id="reopt_final_2" class="tab" style="visibility:hidden">
		<iframe src="reopt_final_2/inlineTemplate.html" style="height:100vh"></iframe>
	</div>
	
	<div id="reopt_final_3" class="tab" style="visibility:hidden">
		<iframe src="reopt_final_3/inlineTemplate.html" style="height:100vh"></iframe>
	</div>
	
</body>
</html>