<!DOCTYPE html>
<html>
<head>
	<title>GeoJSON Map</title>
<head>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
		crossorigin="" />
	<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js" integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
		crossorigin=""></script>
	<script src="https://unpkg.com/esri-leaflet@2.5.0/dist/esri-leaflet.js" integrity="sha512-ucw7Grpc+iEQZa711gcjgMBnmd9qju1CICsRaryvX7HJklK0pGl/prxKvtHwpgm5ZHdvAil7YPxI1oWPOWK3UQ==" crossorigin=""></script>
	<script src="https://cdn.maptiler.com/mapbox-gl-js/v1.5.1/mapbox-gl.js"></script>
	<script src="https://cdn.maptiler.com/mapbox-gl-leaflet/latest/leaflet-mapbox-gl.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.3/leaflet.css" />
	<link rel="stylesheet" href="https://cdn.maptiler.com/mapbox-gl-js/v1.5.1/mapbox-gl.css" />
	<script src='https://unpkg.com/@turf/turf@6/turf.min.js'></script>
</head>
	<style>html, body {
		width: 100%;
		height: 100%;
		margin: 0;
		padding: 0;}
	</style>
	<style>#map{
		position: relative;
		width: 100.0%;
		height: 100.0%;
		left: 0.0%;
		top: 0.0%;
		}
	</style>
</head>
<body>
	<div id="map"></div>
	<script>var geojson={"features": [{"geometry": {"coordinates": [[-84.07142918138702, 30.28482345532285], [-84.071493, 30.285013]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.071493, 30.285013], [-84.0715666804142, 30.284827066687857]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.071493, 30.285013], [-84.071993, 30.285013]], "type": "LineString"}, "properties": {"!FROCODE": ".1.2.3", "!TOCODE": ".1.2.3", "%rs": "[0.0005,0.0005]", "conns": "[delta,wye]", "from": "sourcebus", "kvas": "[5000,5000]", "kvs": "[115,4.16]", "name": "sub", "object": "transformer", "phases": "3", "to": "650", "type": "transformer", "windings": "2", "xhl": "0.008"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.07565684136706, 30.28489830036426], [-84.075493, 30.285013]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.075493, 30.285013], [-84.074493, 30.285013]], "type": "LineString"}, "properties": {"!FROCODE": ".1.2.3", "!TOCODE": ".1.2.3", "from": "671", "length": "1000", "linecode": "mtx601", "name": "671680", "object": "line", "phases": "3", "switch": "y", "to": "680", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.071993, 30.285013], [-84.072493, 30.285013]], "type": "LineString"}, "properties": {"!FROCODE": ".3", "!TOCODE": ".3", "%loadloss": "0.01", "bank": "reg1", "from": "650", "kvas": "[1666,1666]", "kvs": "[2.4,2.4]", "name": "reg3", "object": "transformer", "phases": "1", "to": "rg60", "type": "transformer", "xhl": "0.01"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072493, 30.285013], [-84.072993, 30.285013]], "type": "LineString"}, "properties": {"!FROCODE": ".1.2.3", "!TOCODE": ".1.2.3", "from": "rg60", "length": "2000", "linecode": "mtx601", "name": "650632", "object": "line", "phases": "3", "switch": "y", "to": "632", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.286513], [-84.072993, 30.287013]], "type": "LineString"}, "properties": {"!FROCODE": ".1.2.3", "!TOCODE": ".1.2.3", "%rs": "[0.55,0.55]", "conns": "[wye,wye]", "from": "633", "kvas": "[500,500]", "kvs": "[4.16,0.480]", "name": "xfm1", "object": "transformer", "phases": "3", "to": "634", "type": "transformer", "windings": "2", "xhl": "2", "xht": "1", "xlt": "1"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.286513], [-84.072993, 30.285013]], "type": "LineString"}, "properties": {"!FROCODE": ".1", "!TOCODE": ".1", "from": "632", "length": "500", "linecode": "mtx602", "name": "632633", "object": "line", "phases": "1", "switch": "y", "to": "633", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.286513], [-84.07279413150235, 30.286534244308523]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.286513], [-84.07310396775699, 30.286346608422967]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.286513], [-84.07280654564063, 30.286440648276642]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.286513], [-84.0728127136326, 30.286599584211796]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.287013], [-84.07284499738282, 30.2871475184943]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.287013], [-84.07289361782463, 30.286839439684204]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.287013], [-84.07303522679813, 30.287208491425694]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.287013], [-84.07312047391558, 30.287167111650582]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.287013], [-84.07305860071652, 30.28720193529578]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.07434321655076, 30.284145532706646], [-84.074493, 30.284013]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.074493, 30.284013], [-84.074493, 30.283013]], "type": "LineString"}, "properties": {"!FROCODE": ".3", "!TOCODE": ".3", "from": "684", "length": "300", "linecode": "mtx605", "name": "684611", "object": "line", "phases": "1", "to": "611", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.074493, 30.284013], [-84.075493, 30.284013]], "type": "LineString"}, "properties": {"!FROCODE": ".3", "!TOCODE": ".3", "from": "684", "length": "800", "linecode": "mtx607", "name": "684652", "object": "line", "phases": "1", "to": "652", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.074493, 30.284013], [-84.074493, 30.285013]], "type": "LineString"}, "properties": {"!FROCODE": ".3", "!TOCODE": ".3", "from": "671", "length": "300", "linecode": "mtx604", "name": "671684", "object": "line", "phases": "1", "switch": "y", "to": "684", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.07279345696186, 30.28399948793385], [-84.072993, 30.284013]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.284013], [-84.072993, 30.283013]], "type": "LineString"}, "properties": {"!FROCODE": ".2", "!TOCODE": ".2", "from": "645", "length": "300", "linecode": "mtx603", "name": "645646", "object": "line", "phases": "1", "to": "646", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.284013], [-84.072993, 30.285013]], "type": "LineString"}, "properties": {"!FROCODE": ".2", "!TOCODE": ".2", "from": "632", "length": "500", "linecode": "mtx603", "name": "632645", "object": "line", "phases": "1", "switch": "y", "to": "645", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.284013], [-84.07310423095844, 30.283846784255005]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.284013], [-84.0730615958264, 30.284200868604614]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.284013], [-84.07285680838433, 30.284159464479725]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.072993, 30.284013], [-84.07286173856123, 30.283862101243574]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.07298030621337, 30.282813403237046], [-84.072993, 30.283013]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.07469193489399, 30.28549238670437], [-84.074493, 30.285513]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.074493, 30.285513], [-84.074493, 30.287013]], "type": "LineString"}, "properties": {"!FROCODE": ".1.2.3", "!TOCODE": ".1.2.3", "from": "692", "length": "500", "linecode": "mtx606", "name": "692675", "object": "line", "phases": "3", "to": "675", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.074493, 30.285513], [-84.074493, 30.285013]], "type": "LineString"}, "properties": {"!FROCODE": ".1.2.3", "!TOCODE": ".1.2.3", "c0": "0.000", "c1": "0.000", "from": "671", "name": "671692", "object": "line", "phases": "3", "r0": "1e-4", "r1": "1e-4", "switch": "y", "to": "692", "type": "line", "x0": "0.000", "x1": "0.000"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.07444864898416, 30.286817979520578], [-84.074493, 30.287013]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.074493, 30.287013], [-84.07457961878501, 30.286832730240793]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.074493, 30.287013], [-84.07456568059722, 30.286826673590742]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.074493, 30.287013], [-84.07444584911259, 30.286818637468077]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.074493, 30.287013], [-84.07435021779155, 30.287153047281112]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.07435243303476, 30.28315527061637], [-84.074493, 30.283013]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.074493, 30.283013], [-84.07444685419789, 30.282818396390198]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.0754409860358, 30.28420611796273], [-84.075493, 30.284013]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.07331693111306, 30.285107866996626], [-84.073493, 30.285013]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.073493, 30.285013], [-84.07329538414037, 30.28504378915432]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.073493, 30.285013], [-84.07329767918675, 30.285056009067794]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.073493, 30.285013], [-84.074493, 30.285013]], "type": "LineString"}, "properties": {"!FROCODE": ".1.2.3", "!TOCODE": ".1.2.3", "from": "670", "length": "1333", "linecode": "mtx601", "name": "670671", "object": "line", "phases": "3", "to": "671", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.073493, 30.285013], [-84.072993, 30.285013]], "type": "LineString"}, "properties": {"!FROCODE": ".1.2.3", "!TOCODE": ".1.2.3", "from": "632", "length": "667", "linecode": "mtx601", "name": "632670", "object": "line", "phases": "3", "switch": "y", "to": "670", "type": "line", "units": "ft"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.073493, 30.285013], [-84.07342583902917, 30.285201386315844]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.073493, 30.285013], [-84.07341950573793, 30.28482699302851]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.073493, 30.285013], [-84.07351999255376, 30.28521117013408]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [[-84.073493, 30.285013], [-84.07369193734324, 30.28499241035544]], "type": "LineString"}, "properties": {"phases": 1, "type": "parentChild"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07142918138702, 30.28482345532285], "type": "Point"}, "properties": {"angle": "30", "basekv": "115", "latitude": "30.28482345532285", "longitude": "-84.07142918138702", "mvasc1": "21000", "mvasc3": "20000", "name": "lehigh", "object": "circuit", "parent": "sourcebus", "phases": "3", "pos": [30.28482345532285, -84.07142918138702], "pu": "1.0001", "type": "circuit"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.071493, 30.285013], "type": "Point"}, "properties": {"latitude": "30.285013", "longitude": "-84.071493", "name": "sourcebus", "object": "bus", "pos": [30.285013, -84.071493], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.0715666804142, 30.284827066687857], "type": "Point"}, "properties": {"!CMD": "edit", "!CONNCODE": ".1.2.3", "basekv": "115", "latitude": "30.284827066687857", "longitude": "-84.0715666804142", "name": "source", "object": "vsource", "parent": "sourcebus", "pos": [30.284827066687857, -84.0715666804142], "pu": "1.00", "r0": "0", "r1": "0", "type": "vsource", "x0": "0.0001", "x1": "0.0001"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07565684136706, 30.28489830036426], "type": "Point"}, "properties": {"!CONNCODE": ".1.2.3", "basekv": "4.16", "latitude": "30.28489830036426", "longitude": "-84.07565684136706", "name": "secondsource", "object": "vsource", "parent": "680", "pos": [30.28489830036426, -84.07565684136706], "pu": "1.00", "r0": "0", "r1": "0", "type": "vsource", "x0": "0.0001", "x1": "0.0001"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.075493, 30.285013], "type": "Point"}, "properties": {"latitude": "30.285013", "longitude": "-84.075493", "name": "680", "object": "bus", "pos": [30.285013, -84.075493], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.071993, 30.285013], "type": "Point"}, "properties": {"latitude": "30.285013", "longitude": "-84.071993", "name": "650", "object": "bus", "pos": [30.285013, -84.071993], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.072493, 30.285013], "type": "Point"}, "properties": {"latitude": "30.285013", "longitude": "-84.072493", "name": "rg60", "object": "bus", "pos": [30.285013, -84.072493], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.072993, 30.286513], "type": "Point"}, "properties": {"latitude": "30.286513", "longitude": "-84.072993", "name": "633", "object": "bus", "pos": [30.286513, -84.072993], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.072993, 30.287013], "type": "Point"}, "properties": {"latitude": "30.287013", "longitude": "-84.072993", "name": "634", "object": "bus", "pos": [30.287013, -84.072993], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07434321655076, 30.284145532706646], "type": "Point"}, "properties": {"!CONNCODE": ".3", "conn": "wye", "kv": "2.4", "kvar": "660", "kw": "1155", "latitude": "30.284145532706646", "longitude": "-84.07434321655076", "model": "1", "name": "684_command_center", "object": "load", "parent": "684", "phases": "1", "pos": [30.284145532706646, -84.07434321655076], "type": "load", "yearly": "684_command_center_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.074493, 30.284013], "type": "Point"}, "properties": {"latitude": "30.284013", "longitude": "-84.074493", "name": "684", "object": "bus", "pos": [30.284013, -84.074493], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07284499738282, 30.2871475184943], "type": "Point"}, "properties": {"!CONNCODE": ".1", "conn": "wye", "kv": "0.277", "kvar": "110", "kw": "160", "latitude": "30.2871475184943", "longitude": "-84.07284499738282", "model": "1", "name": "634a_data_center", "object": "load", "parent": "634", "phases": "1", "pos": [30.2871475184943, -84.07284499738282], "type": "load", "yearly": "634a_data_center_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07289361782463, 30.286839439684204], "type": "Point"}, "properties": {"!CONNCODE": ".1", "conn": "wye", "kv": "0.277", "kvar": "90", "kw": "120", "latitude": "30.286839439684204", "longitude": "-84.07289361782463", "model": "1", "name": "634b_radar", "object": "load", "parent": "634", "phases": "1", "pos": [30.286839439684204, -84.07289361782463], "type": "load", "yearly": "634b_radar_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07303522679813, 30.287208491425694], "type": "Point"}, "properties": {"!CONNCODE": ".1", "conn": "wye", "kv": "0.277", "kvar": "90", "kw": "120", "latitude": "30.287208491425694", "longitude": "-84.07303522679813", "model": "1", "name": "634c_atc_tower", "object": "load", "parent": "634", "phases": "1", "pos": [30.287208491425694, -84.07303522679813], "type": "load", "yearly": "634c_atc_tower_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07279345696186, 30.28399948793385], "type": "Point"}, "properties": {"!CONNCODE": ".2", "conn": "wye", "kv": "2.4", "kvar": "125", "kw": "170", "latitude": "30.28399948793385", "longitude": "-84.07279345696186", "model": "1", "name": "645_hangar", "object": "load", "parent": "645", "phases": "1", "pos": [30.28399948793385, -84.07279345696186], "type": "load", "yearly": "645_hangar_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.072993, 30.284013], "type": "Point"}, "properties": {"latitude": "30.284013", "longitude": "-84.072993", "name": "645", "object": "bus", "pos": [30.284013, -84.072993], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07298030621337, 30.282813403237046], "type": "Point"}, "properties": {"!CONNCODE": ".2", "conn": "wye", "kv": "2.4", "kvar": "132", "kw": "230", "latitude": "30.282813403237046", "longitude": "-84.07298030621337", "model": "2", "name": "646_office", "object": "load", "parent": "646", "phases": "1", "pos": [30.282813403237046, -84.07298030621337], "type": "load", "yearly": "646_office_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.072993, 30.283013], "type": "Point"}, "properties": {"latitude": "30.283013", "longitude": "-84.072993", "name": "646", "object": "bus", "pos": [30.283013, -84.072993], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07469193489399, 30.28549238670437], "type": "Point"}, "properties": {"!CONNCODE": ".1.2.3", "conn": "delta", "kv": "2.4", "kvar": "151", "kw": "170", "latitude": "30.28549238670437", "longitude": "-84.07469193489399", "model": "5", "name": "692_warehouse2", "object": "load", "parent": "692", "phases": "3", "pos": [30.28549238670437, -84.07469193489399], "type": "load", "yearly": "692_warehouse2_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.074493, 30.285513], "type": "Point"}, "properties": {"latitude": "30.285513", "longitude": "-84.074493", "name": "692", "object": "bus", "pos": [30.285513, -84.074493], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07444864898416, 30.286817979520578], "type": "Point"}, "properties": {"!CONNCODE": ".1.2.3", "conn": "wye", "kv": "2.4", "kvar": "190", "kw": "485", "latitude": "30.286817979520578", "longitude": "-84.07444864898416", "model": "1", "name": "675a_hospital", "object": "load", "parent": "675", "phases": "3", "pos": [30.286817979520578, -84.07444864898416], "type": "load", "yearly": "675a_hospital_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.074493, 30.287013], "type": "Point"}, "properties": {"latitude": "30.287013", "longitude": "-84.074493", "name": "675", "object": "bus", "pos": [30.287013, -84.074493], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07457961878501, 30.286832730240793], "type": "Point"}, "properties": {"!CONNCODE": ".1.2.3", "conn": "wye", "kv": "2.4", "kvar": "60", "kw": "68", "latitude": "30.286832730240793", "longitude": "-84.07457961878501", "model": "1", "name": "675b_residential1", "object": "load", "parent": "675", "phases": "3", "pos": [30.286832730240793, -84.07457961878501], "type": "load", "yearly": "675b_residential1_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07456568059722, 30.286826673590742], "type": "Point"}, "properties": {"!CONNCODE": ".1.2.3", "conn": "wye", "kv": "2.4", "kvar": "212", "kw": "290", "latitude": "30.286826673590742", "longitude": "-84.07456568059722", "model": "1", "name": "675c_residential1", "object": "load", "parent": "675", "phases": "3", "pos": [30.286826673590742, -84.07456568059722], "type": "load", "yearly": "675c_residential1_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07435243303476, 30.28315527061637], "type": "Point"}, "properties": {"!CONNCODE": ".3", "conn": "wye", "kv": "2.4", "kvar": "80", "kw": "170", "latitude": "30.28315527061637", "longitude": "-84.07435243303476", "model": "5", "name": "611_runway", "object": "load", "parent": "611", "phases": "1", "pos": [30.28315527061637, -84.07435243303476], "type": "load", "yearly": "611_runway_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.074493, 30.283013], "type": "Point"}, "properties": {"latitude": "30.283013", "longitude": "-84.074493", "name": "611", "object": "bus", "pos": [30.283013, -84.074493], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.0754409860358, 30.28420611796273], "type": "Point"}, "properties": {"!CONNCODE": ".3", "conn": "wye", "kv": "2.4", "kvar": "86", "kw": "128", "latitude": "30.28420611796273", "longitude": "-84.0754409860358", "model": "2", "name": "652_residential", "object": "load", "parent": "652", "phases": "1", "pos": [30.28420611796273, -84.0754409860358], "type": "load", "yearly": "652_residential_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.075493, 30.284013], "type": "Point"}, "properties": {"latitude": "30.284013", "longitude": "-84.075493", "name": "652", "object": "bus", "pos": [30.284013, -84.075493], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07331693111306, 30.285107866996626], "type": "Point"}, "properties": {"!CONNCODE": ".1", "conn": "wye", "kv": "2.4", "kvar": "10", "kw": "17", "latitude": "30.285107866996626", "longitude": "-84.07331693111306", "model": "1", "name": "670a_residential2", "object": "load", "parent": "670", "phases": "1", "pos": [30.285107866996626, -84.07331693111306], "type": "load", "yearly": "670a_residential2_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.073493, 30.285013], "type": "Point"}, "properties": {"latitude": "30.285013", "longitude": "-84.073493", "name": "670", "object": "bus", "pos": [30.285013, -84.073493], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07329538414037, 30.28504378915432], "type": "Point"}, "properties": {"!CONNCODE": ".2", "conn": "wye", "kv": "2.4", "kvar": "38", "kw": "66", "latitude": "30.28504378915432", "longitude": "-84.07329538414037", "model": "1", "name": "670b_residential2", "object": "load", "parent": "670", "phases": "1", "pos": [30.28504378915432, -84.07329538414037], "type": "load", "yearly": "670b_residential2_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07329767918675, 30.285056009067794], "type": "Point"}, "properties": {"!CONNCODE": ".3", "conn": "wye", "kv": "2.4", "kvar": "68", "kw": "117", "latitude": "30.285056009067794", "longitude": "-84.07329767918675", "model": "1", "name": "670c_residential2", "object": "load", "parent": "670", "phases": "1", "pos": [30.285056009067794, -84.07329767918675], "type": "load", "yearly": "670c_residential2_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07312047391558, 30.287167111650582], "type": "Point"}, "properties": {"!CONNCODE": ".1", "kv": "0.277", "kw": "440", "latitude": "30.287167111650582", "longitude": "-84.07312047391558", "name": "solar_634_existing", "object": "generator", "parent": "634", "pf": "1", "phases": "1", "pos": [30.287167111650582, -84.07312047391558], "type": "generator", "yearly": "solar_634_existing_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07305860071652, 30.28720193529578], "type": "Point"}, "properties": {"!CONNCODE": ".1", "%charge": "100", "%discharge": "100", "%effcharge": "96", "%effdischarge": "96", "%idlingkw": "0", "dispmode": "follow", "kv": "0.277", "kwhrated": "307", "kwhstored": "307", "kwrated": "79", "latitude": "30.28720193529578", "longitude": "-84.07305860071652", "name": "battery_634_existing", "object": "storage", "parent": "634", "phases": "1", "pos": [30.28720193529578, -84.07305860071652], "type": "storage", "yearly": "battery_634_existing_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07444584911259, 30.286818637468077], "type": "Point"}, "properties": {"!CONNCODE": ".1.2.3", "h": "2", "kv": "2.4", "kw": "265", "latitude": "30.286818637468077", "longitude": "-84.07444584911259", "name": "fossil_675_existing", "object": "generator", "parent": "675", "pf": "1", "phases": "3", "pos": [30.286818637468077, -84.07444584911259], "type": "generator", "xdp": "0.27", "xdpp": "0.2", "yearly": "fossil_675_existing_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07435021779155, 30.287153047281112], "type": "Point"}, "properties": {"kv": "2.4", "kvar": "600", "latitude": "30.287153047281112", "longitude": "-84.07435021779155", "name": "cap1", "object": "capacitor", "parent": "675", "phases": "3", "pos": [30.287153047281112, -84.07435021779155], "type": "capacitor"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07444685419789, 30.282818396390198], "type": "Point"}, "properties": {"!CONNCODE": ".3", "kv": "2.4", "kvar": "100", "latitude": "30.282818396390198", "longitude": "-84.07444685419789", "name": "cap2", "object": "capacitor", "parent": "611", "phases": "1", "pos": [30.282818396390198, -84.07444685419789], "type": "capacitor"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.074493, 30.285013], "type": "Point"}, "properties": {"latitude": "30.285013", "longitude": "-84.074493", "name": "671", "object": "bus", "pos": [30.285013, -84.074493], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.072993, 30.285013], "type": "Point"}, "properties": {"latitude": "30.285013", "longitude": "-84.072993", "name": "632", "object": "bus", "pos": [30.285013, -84.072993], "type": "bus"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07279413150235, 30.286534244308523], "type": "Point"}, "properties": {"!CONNCODE": ".1", "%charge": "100", "%discharge": "100", "%effcharge": "96", "%effdischarge": "96", "%idlingkw": "0", "dispmode": "follow", "kv": "2.4017771198288433", "kwhrated": "815.8112076898644", "kwhstored": "815.8112076898644", "kwrated": "143.9167299820304", "latitude": "30.286534244308523", "longitude": "-84.07279413150235", "name": "battery_633", "object": "storage", "parent": "633", "phases": "1", "pos": [30.286534244308523, -84.07279413150235], "type": "storage", "yearly": "battery_633_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07310396775699, 30.286346608422967], "type": "Point"}, "properties": {"!CONNCODE": ".1", "kv": "2.4017771198288433", "kw": "1.0", "latitude": "30.286346608422967", "longitude": "-84.07310396775699", "name": "wind_633", "object": "generator", "parent": "633", "pf": "1", "phases": "1", "pos": [30.286346608422967, -84.07310396775699], "type": "generator", "yearly": "wind_633_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07280654564063, 30.286440648276642], "type": "Point"}, "properties": {"!CONNCODE": ".1", "h": "2", "kv": "2.4017771198288433", "kw": "200.0", "latitude": "30.286440648276642", "longitude": "-84.07280654564063", "name": "fossil_633", "object": "generator", "parent": "633", "phases": "1", "pos": [30.286440648276642, -84.07280654564063], "type": "generator", "xdp": "0.27", "xdpp": "0.2", "yearly": "fossil_633_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.0728127136326, 30.286599584211796], "type": "Point"}, "properties": {"!CONNCODE": ".1", "kv": "2.4017771198288433", "kw": "335.06510000000003", "latitude": "30.286599584211796", "longitude": "-84.0728127136326", "name": "solar_633", "object": "generator", "parent": "633", "pf": "1", "phases": "1", "pos": [30.286599584211796, -84.0728127136326], "type": "generator", "yearly": "solar_633_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07310423095844, 30.283846784255005], "type": "Point"}, "properties": {"!CONNCODE": ".2", "%charge": "100", "%discharge": "100", "%effcharge": "96", "%effdischarge": "96", "%idlingkw": "0", "dispmode": "follow", "kv": "2.4017771198288433", "kwhrated": "286.1352321609502", "kwhstored": "286.1352321609502", "kwrated": "111.57787241404202", "latitude": "30.283846784255005", "longitude": "-84.07310423095844", "name": "battery_645", "object": "storage", "parent": "645", "phases": "1", "pos": [30.283846784255005, -84.07310423095844], "type": "storage", "yearly": "battery_645_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.0730615958264, 30.284200868604614], "type": "Point"}, "properties": {"!CONNCODE": ".2", "kv": "2.4017771198288433", "kw": "1.0", "latitude": "30.284200868604614", "longitude": "-84.0730615958264", "name": "wind_645", "object": "generator", "parent": "645", "pf": "1", "phases": "1", "pos": [30.284200868604614, -84.0730615958264], "type": "generator", "yearly": "wind_645_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07285680838433, 30.284159464479725], "type": "Point"}, "properties": {"!CONNCODE": ".2", "h": "2", "kv": "2.4017771198288433", "kw": "43.980382985398165", "latitude": "30.284159464479725", "longitude": "-84.07285680838433", "name": "fossil_645", "object": "generator", "parent": "645", "phases": "1", "pos": [30.284159464479725, -84.07285680838433], "type": "generator", "xdp": "0.27", "xdpp": "0.2", "yearly": "fossil_645_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07286173856123, 30.283862101243574], "type": "Point"}, "properties": {"!CONNCODE": ".2", "kv": "2.4017771198288433", "kw": "575.1042", "latitude": "30.283862101243574", "longitude": "-84.07286173856123", "name": "solar_645", "object": "generator", "parent": "645", "pf": "1", "phases": "1", "pos": [30.283862101243574, -84.07286173856123], "type": "generator", "yearly": "solar_645_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07342583902917, 30.285201386315844], "type": "Point"}, "properties": {"!CONNCODE": ".1.2.3", "%charge": "100", "%discharge": "100", "%effcharge": "96", "%effdischarge": "96", "%idlingkw": "0", "dispmode": "follow", "kv": "2.4017771198288433", "kwhrated": "5225.684120723113", "kwhstored": "5225.684120723113", "kwrated": "828.3567165721579", "latitude": "30.285201386315844", "longitude": "-84.07342583902917", "name": "battery_670", "object": "storage", "parent": "670", "phases": "3", "pos": [30.285201386315844, -84.07342583902917], "type": "storage", "yearly": "battery_670_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07341950573793, 30.28482699302851], "type": "Point"}, "properties": {"!CONNCODE": ".1.2.3", "kv": "2.4017771198288433", "kw": "1.0", "latitude": "30.28482699302851", "longitude": "-84.07341950573793", "name": "wind_670", "object": "generator", "parent": "670", "pf": "1", "phases": "3", "pos": [30.28482699302851, -84.07341950573793], "type": "generator", "yearly": "wind_670_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07351999255376, 30.28521117013408], "type": "Point"}, "properties": {"!CONNCODE": ".1.2.3", "h": "2", "kv": "2.4017771198288433", "kw": "640.0", "latitude": "30.28521117013408", "longitude": "-84.07351999255376", "name": "fossil_670", "object": "generator", "parent": "670", "phases": "3", "pos": [30.28521117013408, -84.07351999255376], "type": "generator", "xdp": "0.27", "xdpp": "0.2", "yearly": "fossil_670_shape"}, "type": "Feature"}, {"geometry": {"coordinates": [-84.07369193734324, 30.28499241035544], "type": "Point"}, "properties": {"!CONNCODE": ".1.2.3", "kv": "2.4017771198288433", "kw": "5032.2439", "latitude": "30.28499241035544", "longitude": "-84.07369193734324", "name": "solar_670", "object": "generator", "parent": "670", "pf": "1", "phases": "3", "pos": [30.28499241035544, -84.07369193734324], "type": "generator", "yearly": "solar_670_shape"}, "type": "Feature"}], "type": "FeatureCollection"}</script>
	<script>var all_mg_elements=null</script>
	<script type="text/javascript">
	function onEachFeature(feature, layer) {
		var popupContent = '';
		for (const key in feature.properties) {
			if (feature.properties.hasOwnProperty(key)) {
				value = feature.properties[key]
				popupContent += '<div>' + key + ': <b>' + value + '</b></div>'
				layer.bindPopup(popupContent);
			}
		}
	}

	function pointToLayerNode(feature, latlng) {
		let fillColorValue = 'gray';
		if (feature.properties['pointColor']){
			fillColorValue = feature.properties['pointColor'];
		} else if (feature.properties.object === 'capacitor'){
			fillColorValue = 'purple'
		} else if (feature.properties.object === 'generator' || feature.properties.object === 'storage'){
			fillColorValue = 'red'
		} else if (feature.properties.object === 'load'){
			fillColorValue = 'blue'
		}
		return L.circleMarker(latlng, {
			radius: 5,
			fillColor: fillColorValue,
			color: "#000",
			weight: 1,
			opacity: 1,
			fillOpacity: 0.8
		});
	}

	function lineStyle(feature){
		if (feature.geometry['type'] == 'LineString'){
			if (feature.properties.edgeColor){
				return {
					"color": feature.properties.edgeColor
				}
			} else if (feature.properties.object === 'transformer'){
				return {
					"color": "orange"
				}
			} else {
				return {
					"color": "black"
				}
			}
		}
		else if (feature.geometry['type'] == 'Polygon'){
			return {
				"color": "blue"
			}
		}
	}
	geojsonLayer = L.geoJSON(false, {
				pointToLayer: pointToLayerNode,
				onEachFeature: onEachFeature,
				style: lineStyle,
			});
	geojson.features.forEach(function(feature){
		if (feature.geometry['type'] == 'Point'){
			geojsonLayer.addData(feature);
		}
		else if (feature.geometry['type'] == 'LineString'){
			geojsonLayer.addData(feature);
		}
		else if (feature.geometry['type'] == 'Polygon'){
			geojsonLayer.addData(feature);
		}
	});
	var bounds = geojsonLayer.getBounds();
	// Forcing of canvas renderer:
	var map = L.map('map', {renderer: L.canvas()}).fitBounds(bounds);
	// Optional SVG Renderer:
	// var map = L.map('map').fitBounds(bounds);
	var esri_images = L.esri.basemapLayer('Imagery').addTo(map);
	var topo = L.esri.basemapLayer('Streets');
	var blank = L.tileLayer('');
	var gl = L.mapboxGL({
		attribution: "",
		style: 'https://api.maptiler.com/maps/basic/style.json?key=WOwRKyy0L6AwPBuM4Ggj'
	});
	// Generate hulls for microgrids
	allHulls = L.layerGroup()
	// Add new hull to map for each microgrid.
	var check_box_elements = {}
	if (all_mg_elements != null) {
		for (i = 0; i < Object.keys(all_mg_elements).length; i++) {
			var mgFeatureCollection = turf.featureCollection(features = [])
			var mg = all_mg_elements[Object.keys(all_mg_elements)[i]]
			// If geojson feature is in mg, add a turf point.
			for (j = 0; j < Object.keys(geojson.features).length; j++) {
				let isPoint = geojson['features'][j]['geometry']['type'] == 'Point'
				let itemName = geojson['features'][j]['properties']['name']
				if (isPoint && mg.indexOf(itemName) > -1) {
					mgFeatureCollection['features'].push(turf.point(geojson['features'][j]['geometry']['coordinates']))
				}
			}
			var hull = turf.convex(mgFeatureCollection);
			hullLayer = L.geoJSON(hull).bindPopup(Object.keys(all_mg_elements)[i])
			allHulls.addLayer(hullLayer)
			// hullLayer.addTo(map)
		}
		allHulls.addTo(map)
		check_box_elements['Hulls'] = allHulls
	}
	// Add layer control
	var layerControl = L.control.layers(
		{
			'Satellite': esri_images,
			'Streets': gl,
			'Topo': topo,
			'Blank': blank
		},
		check_box_elements,
		{
			position: 'topleft',
			collapsed: false		
		}
	).addTo(map);	
	mapLink = '<a href="http://openstreetmap.org">OpenStreetMap</a>';
	L.control.scale().addTo(map);
	geojsonLayer.addTo(map);
</script>
</body>
</html>